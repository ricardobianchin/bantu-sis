BARRAS

DBATUALIZ INI
DBATUALIZ_ASSUNTO=BARRAS
DBATUALIZ_OBJETIVO=CRIAR BARRAS
DBATUALIZ_OBS=



/////////////////////////
//
// TABELA PROD_BARRAS
//
/////////////////////////

COMANDO INI
TIPO_COMANDO=CREATE TABLE
OBJETO_NOME=PROD_BARRAS

COLUNAS INI
//NOME;TIPO;NOT NULL;PRIM;UNIQUE

//NOME    TIPO    NOTNULL    PRIM    UNIQUE

PROD_ID;ID_DOM;S;S;N
ORDEM_ID;ID_SHORT_DOM;S;S;N
COD_BARRAS;CHAR(14);S;N;S

COLUNAS FIM
COMANDO FIM
//TABELA PROD_BARRAS FIM



//////////////////////////////////
//
// INDEX COD_BARRAS
//
//////////////////////////////////
COMANDO INI
TIPO_COMANDO=CREATE INDEX
OBJETO_NOME=
TABELA=PROD_BARRAS
CAMPOS=COD_BARRAS
COMANDO FIM
//OBJETO_NOME Nao É obrigatorio
// INDEX COD_BARRAS



//////////////////////////////////
//
// FOREIGN KEY PROD_BARRAS PROD
//
//////////////////////////////////
COMANDO INI
TIPO_COMANDO=CREATE FOREIGN KEY
//OBJETO_NOME=
TABELA_FK=PROD_BARRAS
CAMPOS_FK=PROD_ID
TABELA_PK=PROD
//CAMPOS_PK=
COMANDO FIM
//OBJETO_NOME e CAMPOS_PK nao sao obrigatorios
// FOREIGN KEY PROD_BARRAS PROD FIM



//PACKAGE PROD_BARRAS_PA

COMANDO INI
TIPO_COMANDO=CREATE OR ALTER PACKAGE
OBJETO_NOME=PROD_BARRAS_PA
```FIREBIRD

SET TERM ^;
CREATE OR ALTER PACKAGE PROD_BARRAS_PA
AS
BEGIN
  PROCEDURE BY_COD_BARRAS_GET
  (
    COD_BARRAS CHAR(14) NOT NULL
    , PROD_ID_EXCETO INTEGER NOT NULL
  )
  RETURNS
  (
    PROD_ID_RET INTEGER
  );
END^

RECREATE PACKAGE BODY PROD_BARRAS_PA
AS
BEGIN
  PROCEDURE BY_COD_BARRAS_GET
  (
    COD_BARRAS CHAR(14) NOT NULL
    , PROD_ID_EXCETO INTEGER NOT NULL
  )
  RETURNS
  (
    PROD_ID_RET INTEGER
  )
  AS
  BEGIN
    SELECT FIRST(1) PROD_ID
    FROM PROD_BARRAS
    WHERE COD_BARRAS = :COD_BARRAS
    AND PROD_ID <> :PROD_ID_EXCETO
    INTO :PROD_ID_RET;

    SUSPEND;
  END
END^
SET TERM ;^

```
COMANDO FIM
//PACKAGE PROD_BARRAS_PA FIM

DBATUALIZ FIM


