SYNC_DO_SERVIDOR_SIS

-----------------------------
TESTES INICIO
-----------------------------

SHOW TABLE SYNC_DO_SERVIDOR_SIS;

SELECT * FROM SYNC_DO_SERVIDOR_SIS;

EXECUTE PROCEDURE SYNC_DO_SERVIDOR_SIS_PA.GARANTIR;
SELECT * FROM SYNC_DO_SERVIDOR_SIS;
EXECUTE PROCEDURE SYNC_DO_SERVIDOR_SIS_PA.ATUALIZAR(10);
SELECT * FROM SYNC_DO_SERVIDOR_SIS;
EXECUTE PROCEDURE SYNC_DO_SERVIDOR_SIS_PA.ATUALIZAR(7);
SELECT * FROM SYNC_DO_SERVIDOR_SIS;
ROLLBACK;


-----------------------------
TESTES FIM 
-----------------------------

-----------------------------
INICIO
-----------------------------

DBATUALIZ INI
DBATUALIZ_ASSUNTO=SIS
DBATUALIZ_OBJETIVO=CRIA SYNC_DO_SERVIDOR_SIS
DBATUALIZ_OBS=


//TABELA SYNC_DO_SERVIDOR_SIS

COMANDO INI
COMANDO_TIPO=CREATE TABLE
OBJETO_NOME=SYNC_DO_SERVIDOR_SIS

COLUNAS INI
//NOME;TIPO;NOT NULL;PRIM;UNIQUE

LOG_ID_SERV_ULTIMO_TRAZIDO;BIGINT;S

COLUNAS FIM
COMANDO FIM
//TABELA SYNC_DO_SERVIDOR FIM



// PACKAGE SYNC_DO_SERVIDOR_SIS_PA
COMANDO INI
COMANDO_TIPO=CREATE OR ALTER PACKAGE
OBJETO_NOME=SYNC_DO_SERVIDOR_SIS_PA

```FIREBIRD
SET TERM ^;
CREATE OR ALTER PACKAGE SYNC_DO_SERVIDOR_SIS_PA
AS
BEGIN
  PROCEDURE GARANTIR;

  PROCEDURE ATUALIZAR
  (
    LOG_ID_SERV_ULTIMO_TRAZIDO BIGINT NOT NULL
  );

END^
/*
----------
BODY
----------
*/
RECREATE PACKAGE BODY SYNC_DO_SERVIDOR_SIS_PA
AS
BEGIN
  PROCEDURE GARANTIR
  AS
  BEGIN
    IF (NOT EXISTS (SELECT 1 FROM SYNC_DO_SERVIDOR_SIS)) THEN
    BEGIN
      INSERT INTO SYNC_DO_SERVIDOR_SIS (LOG_ID_SERV_ULTIMO_TRAZIDO) VALUES (0);
    END
  END

  PROCEDURE ATUALIZAR
  (
    LOG_ID_SERV_ULTIMO_TRAZIDO BIGINT NOT NULL
  )
  AS
  BEGIN
    UPDATE SYNC_DO_SERVIDOR_SIS SET LOG_ID_SERV_ULTIMO_TRAZIDO = :LOG_ID_SERV_ULTIMO_TRAZIDO;
  END
END^
SET TERM ;^
```
COMANDO FIM


DBATUALIZ FIM
