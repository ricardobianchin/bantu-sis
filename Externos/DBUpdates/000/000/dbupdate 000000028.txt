PERFIL_DE_USO_PA


//INICIO
-----------------------------
DBATUALIZ INI
DBATUALIZ_ASSUNTO=ACESSO
DBATUALIZ_OBJETIVO=CRIA PERFIL_DE_USO_PA
DBATUALIZ_OBS=




/*

C:\Pr\app\bantu\bantu-sis\Src\Externos\DBUpdates Complementos\Complementos\Pess\
C:\Pr\app\bantu\bantu-sis\Src\Externos\DBUpdates Complementos\Complementos\Pess\PERFIL_DE_USO_pa.sql

"C:\Program Files\Notepad++\notepad++.exe" "C:\Pr\app\bantu\bantu-sis\Src\Externos\DBUpdates Complementos\Complementos\Pess\PERFIL_DE_USO_pa.sql"

in "C:\Pr\app\bantu\bantu-sis\Src\Externos\DBUpdates Complementos\Complementos\Pess\PERFIL_DE_USO_pa.sql";

show procedure PERFIL_DE_USO_PA.GARANTIR;
*/

//PACKAGE PERFIL_DE_USO_PA

COMANDO INI
TIPO_COMANDO=CREATE OR ALTER PACKAGE
OBJETO_NOME=PERFIL_DE_USO_PA

```FIREBIRD
SET TERM ^;
CREATE OR ALTER PACKAGE PERFIL_DE_USO_PA
AS
BEGIN
  PROCEDURE GARANTIR
  (
    PERFIL_DE_USO_ID ID_SHORT_DOM NOT NULL
    , NOME NOME_REDU_DOM NOT NULL
    , DE_SISTEMA BOOLEAN NOT NULL
  )
    RETURNS
  (
    ID_GRAVADO SMALLINT
  );
  
  PROCEDURE LISTA_GET
  RETURNS 
  (
      PERFIL_DE_USO_ID ID_SHORT_DOM,
      NOME NOME_REDU_NOTN_DOM,
      DE_SISTEMA BOOLEAN
  );

  PROCEDURE BYNOME_GET 
  (
    NOME NOME_REDU_DOM
  )
  RETURNS 
  (
    PERFIL_DE_USO_ID ID_SHORT_DOM,
    DE_SISTEMA BOOLEAN
  );

END^

----- body -----

RECREATE PACKAGE BODY PERFIL_DE_USO_PA
AS
BEGIN
  PROCEDURE GARANTIR
  (
    PERFIL_DE_USO_ID ID_SHORT_DOM NOT NULL
    , NOME NOME_REDU_DOM NOT NULL
    , DE_SISTEMA BOOLEAN NOT NULL
  )
    RETURNS
  (
    ID_GRAVADO SMALLINT
  )
  AS
  BEGIN
    IF (PERFIL_DE_USO_ID < 1) THEN
    BEGIN
      ID_GRAVADO = NEXT VALUE FOR PERFIL_DE_USO_SEQ;
    END
    ELSE
    BEGIN
      ID_GRAVADO = PERFIL_DE_USO_ID;
    END	
	
    UPDATE OR INSERT INTO PERFIL_DE_USO (PERFIL_DE_USO_ID, NOME, DE_SISTEMA)
    VALUES (:ID_GRAVADO, :NOME, :DE_SISTEMA)
    MATCHING (PERFIL_DE_USO_ID);
  END

  PROCEDURE LISTA_GET
  RETURNS (
    PERFIL_DE_USO_ID ID_SHORT_DOM,
    NOME NOME_REDU_NOTN_DOM,
    DE_SISTEMA BOOLEAN
  )
  AS
  BEGIN
    FOR SELECT PERFIL_DE_USO_ID, NOME, DE_SISTEMA FROM PERFIL_DE_USO
    INTO :PERFIL_DE_USO_ID, :NOME, :DE_SISTEMA
    DO
    BEGIN
      SUSPEND;
    END
  END

  PROCEDURE BYNOME_GET
  (
    NOME NOME_REDU_DOM
  )
  RETURNS 
  (
    PERFIL_DE_USO_ID ID_SHORT_DOM,
    DE_SISTEMA BOOLEAN
  )
  AS
  BEGIN
    FOR SELECT PERFIL_DE_USO_ID, DE_SISTEMA
      FROM PERFIL_DE_USO
      WHERE NOME = :NOME
        INTO :PERFIL_DE_USO_ID, :DE_SISTEMA
      DO
        SUSPEND;
  END
END^
SET TERM ;^
```
COMANDO FIM
//PACKAGE PERFIL_DE_USO_PA FIM


DBATUALIZ FIM
