FABRICANTE

//INICIO
-----------------------------
DBATUALIZ INI
DBATUALIZ_ASSUNTO=FABRICANTE
DBATUALIZ_OBJETIVO=CRIA FABRICANTE
DBATUALIZ_OBS=


/////////////////////////
// SEQUENCE FABRICANTE_SEQ
/////////////////////////
COMANDO INI
TIPO_COMANDO=CREATE SEQUENCE
OBJETO_NOME=FABRICANTE_SEQ
//VALOR_INICIAL=0
COMANDO FIM
// SEQUENCE FABRICANTE_SEQ FIM


/////////////////////////
//
// TABELA FABRICANTE
//
/////////////////////////
COMANDO INI

TIPO_COMANDO=CREATE TABLE
OBJETO_NOME=FABRICANTE
COLUNAS INI
//NOME,TIPO,NOT NULL,PRIM

FABRICANTE_ID,ID_SHORT_DOM,N,S
NOME,NOME_RED_DOM,S,N,S
COLUNAS FIM
COMANDO FIM


// PACKAGE FABRICANTE_PA
COMANDO INI
TIPO_COMANDO=CREATE OR ALTER PACKAGE
OBJETO_NOME=FABRICANTE_PA

```FIREBIRD
SET TERM ^;
CREATE OR ALTER PACKAGE FABRICANTE_PA
AS
BEGIN
  PROCEDURE LISTA_GET
  (
    NOME_BUSCA NOME_RED_DOM
  )
  RETURNS
  (
    FABRICANTE_ID SMALLINT
    , NOME NOME_RED_DOM
  );
  PROCEDURE BYID_GET
  (
    FABRICANTE_ID ID_SHORT_DOM 
  )
  RETURNS
  (
    NOME NOME_RED_DOM
  );
  PROCEDURE FABRICANTE_GARANTIR
  (
    FABRICANTE_ID ID_SHORT_DOM
    , NOME NOME_RED_NOTN_DOM
  );

  PROCEDURE BYNOME_GET
  (
    NOME NOME_RED_DOM
  )
  RETURNS
  (
    FABRICANTE_ID SMALLINT
  );
END^

RECREATE PACKAGE BODY FABRICANTE_PA
AS
BEGIN
  PROCEDURE LISTA_GET
  (
    NOME_BUSCA NOME_RED_DOM
  )
  RETURNS
  (
    FABRICANTE_ID SMALLINT
    , NOME NOME_RED_DOM
  )
  AS 
  BEGIN 
    IF (TRIM(NOME_BUSCA) = '') THEN 
      FOR SELECT F.FABRICANTE_ID, F.NOME FROM FABRICANTE F INTO :FABRICANTE_ID, :NOME DO SUSPEND; 
    ELSE 
      FOR SELECT F.FABRICANTE_ID, F.NOME FROM FABRICANTE F WHERE F.NOME LIKE '%'||:NOME_BUSCA||'%' INTO :FABRICANTE_ID, :NOME DO SUSPEND; 
  END

   PROCEDURE BYID_GET
  (
    FABRICANTE_ID ID_SHORT_DOM 
  )
  RETURNS
  (
    NOME NOME_RED_DOM
  )
  AS  
  BEGIN  
    SELECT FIRST(1) F.NOME FROM FABRICANTE F WHERE F.FABRICANTE_ID = :FABRICANTE_ID INTO :NOME;  
    SUSPEND;
  END
  
  PROCEDURE FABRICANTE_GARANTIR
  (
    FABRICANTE_ID ID_SHORT_DOM
    , NOME NOME_RED_NOTN_DOM
  )
  AS
  BEGIN
    IF (FABRICANTE_ID < 1) THEN
    BEGIN
      FABRICANTE_ID = NEXT VALUE FOR FABRICANTE_SEQ;
      INSERT INTO FABRICANTE (FABRICANTE_ID, NOME) VALUES (:FABRICANTE_ID, :NOME);
      EXIT;
    END
    
    UPDATE OR INSERT INTO FABRICANTE (FABRICANTE_ID, NOME)
    VALUES (:FABRICANTE_ID, :NOME)
    MATCHING (FABRICANTE_ID);
  END

  PROCEDURE BYNOME_GET
  (
    NOME NOME_RED_DOM
  )
  RETURNS
  (
    FABRICANTE_ID SMALLINT
  )
  AS
  BEGIN
    SELECT FABRICANTE_ID FROM FABRICANTE WHERE NOME = :NOME INTO :FABRICANTE_ID;
    SUSPEND;
  END
END^
SET TERM ;^
```
COMANDO FIM

DBATUALIZ FIM
