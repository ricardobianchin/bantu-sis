DOMAINS
VERSAO DO BANCO DE DADOS.

inicio
-----------------------------

DBATUALIZ INI
DBATUALIZ_ASSUNTO=DBUPDATE, VERSAO DATABASE
DBATUALIZ_OBJETIVO=CRIAR VERSAO DATABASE, DBUPDATE_HIST, PACKAGE DBUPDATE_PA, DOMAINS BASICOS, COMO O ID_DOM
DBATUALIZ_OBS=


COMANDO INI
TIPO_COMANDO=CREATE DOMAINS
```FIREBIRD

CREATE DOMAIN ID_DOM AS INTEGER NOT NULL;
CREATE DOMAIN ID_SHORT_DOM AS SMALLINT NOT NULL;
CREATE DOMAIN NOME_RED_DOM AS VARCHAR(20);
CREATE DOMAIN NOME_RED_NOTN_DOM AS VARCHAR(20) NOT NULL;
CREATE DOMAIN NOME_LONGO_DOM AS VARCHAR(200);
CREATE DOMAIN PATH_DOM AS VARCHAR(200);
CREATE DOMAIN FRASE_DOM AS VARCHAR(200);
CREATE DOMAIN OBS1_DOM AS VARCHAR(1000);
CREATE DOMAIN DTH_INS_DOM AS TIMESTAMP DEFAULT 'NOW';

```
COMANDO FIM



COMANDO INI
TIPO_COMANDO=CREATE TABLE
OBJETO_NOME=DBUPDATE_HIST
COLUNAS INI
//NOME,TIPO,NOT NULL,PRIM

NUM,ID_DOM,N,S
DTH_INS,DTH_INS_DOM
ASSUNTO,FRASE_DOM,S
OBJETIVO,OBS1_DOM,S
OBS,OBS1_DOM,S

COLUNAS FIM
COMANDO FIM



COMANDO INI
TIPO_COMANDO=CREATE OR ALTER PACKAGE
OBJETO_NOME=DBUPDATE_PA

```FIREBIRD
SET TERM ^;
CREATE OR ALTER PACKAGE DBUPDATE_PA //SQL SECURITY DEFINER
AS
BEGIN
  FUNCTION VERSAO_GET() RETURNS INTEGER;
  
  PROCEDURE HIST_INS
  (
    NUM ID_DOM 
    , ASSUNTO FRASE_DOM NOT NULL
    , OBJETIVO OBS1_DOM NOT NULL
    , OBS OBS1_DOM NOT NULL
  );  
END^
 
RECREATE PACKAGE BODY DBUPDATE_PA
AS
BEGIN
  FUNCTION VERSAO_GET() RETURNS INTEGER 
  AS
  DECLARE VARIABLE MAX_NUM INTEGER;
  BEGIN
    SELECT MAX(NUM) FROM DBUPDATE_HIST INTO :MAX_NUM;
    RETURN COALESCE(MAX_NUM, -1);
  END	

  PROCEDURE HIST_INS
  (
    NUM ID_DOM 
    , ASSUNTO FRASE_DOM NOT NULL
    , OBJETIVO OBS1_DOM NOT NULL
    , OBS OBS1_DOM NOT NULL
  )
  AS
  BEGIN
    INSERT INTO DBUPDATE_HIST(
      NUM
      , ASSUNTO
      , OBJETIVO
      , OBS
    )VALUES(
      :NUM
      , :ASSUNTO
      , :OBJETIVO
      , :OBS
    );
  END
END^
SET TERM ;^
```
COMANDO FIM

DBATUALIZ FIM
